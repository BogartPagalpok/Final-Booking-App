<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Illusive Admin | Master</title>
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,700;1,700&family=Plus+Jakarta+Sans:wght@300;400;800&display=swap" rel="stylesheet">
    <style>
        :root { --gold: #d4af37; --bg: #050505; --glass: rgba(255,255,255,0.08); --border: rgba(212,175,55,0.5); --font-modegi: 'Cormorant Garamond', serif; --red: #ff4444; }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; outline: none; }
        body { background-color: var(--bg); color: #fff; font-family: 'Plus Jakarta Sans', sans-serif; margin: 0; height: 100vh; overflow: hidden; }
        .brand-modegi { font-family: var(--font-modegi); text-transform: uppercase; letter-spacing: 5px; font-weight: 700; font-style: italic; }
        
        .screen { position: fixed; top: 0; left: 0; width: 100%; height: 100%; display: flex; flex-direction: column; align-items: center; justify-content: center; transition: 0.8s; z-index: 10; background: var(--bg); }

        /* CALENDAR */
        .calendar-grid { display: grid; grid-template-columns: repeat(7, 1fr); gap: 8px; text-align: center; }
        .date-num { font-size: 14px; padding: 12px 0; border-radius: 12px; color: #fff; position: relative; cursor: pointer; border: 1.5px solid transparent; }
        .past-date { opacity: 0.1; pointer-events: none; }
        .today { border-color: #fff; }
        .has-booking { color: var(--gold); font-weight: 900; border-color: var(--gold); background: rgba(212, 175, 55, 0.1); }
        .closed-day { color: var(--red); font-weight: 800; border-color: var(--red); background: rgba(255, 68, 68, 0.1); }
        .closed-label { position: absolute; bottom: 2px; left: 0; width: 100%; font-size: 6px; color: var(--red); font-weight: 900; }

        /* LIST & CARDS */
        .list-container { width: 100%; overflow-y: auto; padding: 120px 25px; height: 100vh; }
        .client-card { background: var(--glass); border: 1px solid var(--border); border-radius: 30px; padding: 25px; margin-bottom: 15px; text-align: left; }
        .client-card:active { transform: scale(0.98); background: rgba(212,175,55,0.05); }

        /* DETAIL POPUP */
        #detail-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); backdrop-filter: blur(20px); z-index: 1000; display: none; align-items: center; justify-content: center; padding: 30px; }
        .detail-box { width: 100%; max-width: 400px; background: var(--bg); border: 1px solid var(--gold); border-radius: 35px; padding: 40px; text-align: center; }
        .close-btn { margin-top: 30px; color: var(--gold); border: 1px solid var(--gold); padding: 12px 30px; border-radius: 50px; font-size: 10px; font-weight: 800; cursor: pointer; }
    </style>
</head>
<body>

    <section id="scr-dash" class="screen" style="justify-content: flex-start;">
        <nav style="position:fixed; top:0; width:100%; padding:25px; text-align:center; border-bottom:1px solid var(--border); background:rgba(0,0,0,0.95); z-index:100; backdrop-filter:blur(10px);">
            <div class="brand-modegi" style="font-size: 1rem;">ILLUSIVE PANEL</div>
        </nav>

        <div class="list-container">
            <div style="background: var(--glass); border: 1px solid var(--border); border-radius: 30px; padding: 25px; margin-bottom: 35px; text-align: center;">
                <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px;">
                    <div onclick="changeMonth(-1)" style="color:var(--gold); font-size:1.5rem; width:40px;">←</div>
                    <span id="month-display" class="brand-modegi" style="font-size: 1.2rem;"></span>
                    <div onclick="changeMonth(1)" style="color:var(--gold); font-size:1.5rem; width:40px;">→</div>
                </div>
                <div class="calendar-grid" id="calendar-body"></div>
            </div>

            <p style="font-size: 8px; color: #555; letter-spacing: 2px; margin-bottom: 15px;">CLIENT DIRECTORY</p>
            <div id="cal-list"></div>
        </div>
    </section>

    <div id="detail-overlay">
        <div class="detail-box">
            <h2 id="det-name" class="brand-modegi" style="font-size:1.8rem; margin:0;"></h2>
            <hr style="border:0; border-top:1px solid rgba(212,175,55,0.2); margin:20px 0;">
            <div style="text-align: left; display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                <div>
                    <p style="font-size:8px; color:#888;">DATE</p>
                    <div id="det-date" style="color:var(--gold); font-weight:800;"></div>
                </div>
                <div>
                    <p style="font-size:8px; color:#888;">STYLE</p>
                    <div id="det-style" style="text-transform:uppercase; font-size: 11px; font-weight: 800;"></div>
                </div>
            </div>
            <div style="background:rgba(0,255,136,0.1); color:#00ff88; padding:15px; border-radius:15px; font-size:11px; font-weight:800; margin-top:25px; border:1px solid rgba(0,255,136,0.3);">
                ₱500 VOUCHER ELIGIBLE
            </div>
            <div class="close-btn" onclick="closeDet()">CLOSE PROFILE</div>
        </div>
    </div>

    <script>
        const URL = "https://script.google.com/macros/s/AKfycbweFR7xqCEqOctjzE80V0Ba9vWRsa1Q2FcOqy_a5FIshpR9l6Qa8Fwo1qGpR_lwQ0w5/exec";
        let masterData = [];
        let viewDate = new Date();
        const holidays = { "2026-01-01": "NY", "2026-02-25": "EDSA", "2026-12-25": "Xmas" };

        async function load() {
            try {
                const res = await fetch(URL + "?action=read");
                masterData = await res.json();
                renderCal();
                renderList();
            } catch (e) { console.log("Load Error"); }
        }

        function changeMonth(dir) { viewDate.setMonth(viewDate.getMonth() + dir); renderCal(); }

        function renderCal() {
            const now = new Date();
            const todayStr = `${now.getFullYear()}-${String(now.getMonth()+1).padStart(2,'0')}-${String(now.getDate()).padStart(2,'0')}`;
            const year = viewDate.getFullYear();
            const month = viewDate.getMonth();
            const firstDay = new Date(year, month, 1).getDay();
            const lastDate = new Date(year, month + 1, 0).getDate();
            
            document.getElementById('month-display').innerText = viewDate.toLocaleString('default', { month: 'long', year: 'numeric' });
            
            let html = "";
            for(let i=0; i<firstDay; i++) html += `<div></div>`;
            for(let i=1; i<=lastDate; i++) {
                const dateStr = `${year}-${String(month+1).padStart(2,'0')}-${String(i).padStart(2,'0')}`;
                const isPast = new Date(year, month, i) < new Date(now.getFullYear(), now.getMonth(), now.getDate());
                const isBooked = masterData.some(b => b.date.startsWith(dateStr));
                const isHoliday = holidays[dateStr];
                
                let cls = "date-num";
                if (isPast) cls += " past-date";
                if (dateStr === todayStr) cls += " today";
                if (isHoliday) cls += " closed-day";
                else if (isBooked) cls += " has-booking";
                
                html += `<div class="${cls}">${i}${isHoliday ? '<span class="closed-label">CLOSED</span>' : ''}</div>`;
            }
            document.getElementById('calendar-body').innerHTML = html;
        }

        function renderList() {
            document.getElementById('cal-list').innerHTML = [...masterData].reverse().map((b, i) => `
                <div class="client-card" onclick="showDet(${masterData.length - 1 - i})">
                    <div style="color:var(--gold); font-size:11px; font-weight:800; margin-bottom:5px;">${new Date(b.date).toLocaleDateString('en-US', {month:'short', day:'numeric'})}</div>
                    <div style="font-family:var(--font-modegi); font-size:1.8rem; letter-spacing:1px;">${b.name}</div>
                    <div style="font-size:9px; opacity:0.3; margin-top:10px;">TAP TO VIEW QUOTATION & STYLE</div>
                </div>
            `).join('');
        }

        function showDet(index) {
            const b = masterData[index];
            document.getElementById('det-name').innerText = b.name;
            document.getElementById('det-date').innerText = new Date(b.date).toLocaleDateString('en-US', {month:'long', day:'numeric'});
            document.getElementById('det-style').innerText = b.style;
            document.getElementById('detail-overlay').style.display = "flex";
        }

        function closeDet() { document.getElementById('detail-overlay').style.display = "none"; }

        load();
    </script>
</body>
</html>
